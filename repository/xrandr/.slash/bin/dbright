#!/bin/sh
#
display_usage() {
cat << USAGE
Usage: $(basename "$0") [SIGN] [VALUE] <PARAM>

Increases or decreases display brightness by given VALUE using brightnessctl

VALUE
    A decimal value (percentage) by which display brightness will be changed e.g. +10% or 5%-.

PARAM
    -h|--help       display this message

Examples
    $(basename "$0") +10%
    $(basename "$0") 5%-

USAGE
}

for arg in "$@"; do
    if [ "$arg" = "-h" ] || [ "$arg" = "--help" ]; then
        display_usage
        exit 0
    fi
done

value="$1"

# Check if value is a number (integer or decimal)
if ! echo "$value" | grep -Eq '^[+-]?[0-9]+%?$|^[0-9]+%?[+-]$'; then
    >&2 echo "Invalid value param. Expected decimal or integer. Given: $value"
    notify-send -r 999999999 "Invalid value param. Expected decimal or integer. Given: $value"
    exit 1
fi

# Apply the brightness change
brightnessctl set "${sign}${value}%"

# Fetch and show current brightness level
new_level=$(brightnessctl | grep -oP '\(\K[0-9]+(?=%\))')
notify-send -r 999999999 -t 500 "Brightness: ${new_level}%"
